<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç§‘å®šä¼æ¥­è¡Œå‹•ä¸‹å–®å¹³å°</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f3f4f6; /* Light gray background like HN Point */
            padding-bottom: 80px; /* Space for bottom nav */
        }
        
        /* Hide scrollbar for category list */
        .hide-scroll::-webkit-scrollbar {
            display: none;
        }
        .hide-scroll {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* KD Brand Colors */
        .text-kd { color: #003366; }
        .bg-kd { background-color: #003366; }
        .border-kd { border-color: #003366; }
        
        /* Product Card Shadow */
        .card-shadow {
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        /* Toast Animation */
        @keyframes slideUpFade {
            from { opacity: 0; transform: translate(-50%, 20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }
        .toast-enter {
            animation: slideUpFade 0.3s ease-out forwards;
        }

        /* Share Dialog Styles - Fixed Version */
        .share-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            display: none;
        }
        
        .share-overlay.show {
            display: block;
        }
        
        .share-dialog {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-radius: 20px 20px 0 0;
            padding: 20px;
            min-height: 200px;
        }
        
        .share-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
        }
        
        .share-btn {
            text-align: center;
            cursor: pointer;
            padding: 10px;
        }
        
        .share-btn-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin: 0 auto 8px auto;
        }
        
        .line-btn { background: #00C300; }
        .copy-btn { background: #666; }
        
        .close-btn {
            width: 100%;
            padding: 15px;
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            margin-top: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .share-toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            display: none;
            z-index: 10000;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- 1. Header (Sticky) -->
    <header class="fixed top-0 left-0 right-0 bg-white shadow-sm z-50">
        <div class="flex items-center justify-between px-4 py-3">
            <!-- Logo Area -->
            <div class="flex items-center gap-2">
                <img src="å•†å“åœ–ç‰‡/KD_LOGO.png" alt="ç§‘å®šä¼æ¥­" class="h-8 w-auto">
            </div>
            
            <!-- Actions -->
            <div class="flex items-center gap-4">
                <button class="text-gray-600 text-xl"><i class="fas fa-search"></i></button>
                <button onclick="openShareDialog(event)" class="text-gray-600 text-xl"><i class="fas fa-share-alt"></i></button>
                <div class="relative cursor-pointer" onclick="alert('é€²å…¥è³¼ç‰©è»Š')">
                    <i class="fas fa-shopping-cart text-xl text-kd"></i>
                    <span id="cart-badge" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center border-2 border-white transform scale-0 transition-transform duration-200">0</span>
                </div>
            </div>
        </div>
        
        <!-- Search Bar (Optional, mimic HN Point style) -->
        <div class="px-4 pb-3">
            <div class="relative">
                <input type="text" placeholder="æœå°‹ä¿®è£œæ¼†ã€é»è‘—åŠ‘..." class="w-full bg-gray-100 border-none rounded-full py-2 pl-10 pr-4 text-sm focus:ring-2 focus:ring-blue-900 outline-none">
                <i class="fas fa-search absolute left-4 top-2.5 text-gray-400 text-sm"></i>
            </div>
        </div>
    </header>

    <!-- Spacer for Header -->
    <div class="h-[108px]"></div>

    <!-- 2. Banner Area -->
    <div class="px-4 py-3">
        <div class="w-full h-32 bg-gradient-to-r from-gray-800 to-gray-900 rounded-xl flex items-center justify-between px-6 text-white shadow-lg relative overflow-hidden">
            <div class="z-10">
                <h2 class="text-lg font-bold mb-1">APP ä¸‹å–®äº«å„ªæƒ </h2>
                <p class="text-sm text-gray-300">ç¶œåˆææ–™ æ»¿åƒå…é‹</p>
                <button class="mt-2 bg-yellow-500 text-gray-900 text-xs font-bold px-3 py-1.5 rounded-full">ç«‹å³é¸è³¼</button>
            </div>
            <!-- Decorative Icon -->
            <i class="fas fa-tools text-6xl text-white opacity-10 absolute -right-2 -bottom-4"></i>
        </div>
    </div>

    <!-- 3. Category Tabs (Horizontal Scroll) -->
    <div class="bg-white py-2 shadow-sm sticky top-[108px] z-40">
        <div class="flex overflow-x-auto hide-scroll px-4 gap-3" id="category-container">
            <!-- Categories will be injected here -->
        </div>
    </div>

    <!-- 4. Product List -->
    <div class="px-3 py-4">
        <div class="flex items-center justify-between mb-3 px-1">
            <h3 class="font-bold text-gray-700 text-lg">ç†±é–€ææ–™</h3>
            <span class="text-xs text-gray-500">å…± <span id="product-count">0</span> é …å•†å“</span>
        </div>

        <div class="grid grid-cols-2 gap-3" id="product-grid">
            <!-- Products will be injected here via JS -->
        </div>
        
        <!-- Loading Sentinel -->
        <div class="text-center py-6 text-gray-400 text-sm">
            æ²’æœ‰æ›´å¤šå•†å“äº†
        </div>
    </div>

    <!-- 5. Bottom Navigation (Fixed) -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 pb-safe z-50 h-[60px] flex justify-around items-center">
        <a href="#" class="flex flex-col items-center gap-1 text-kd w-1/5">
            <i class="fas fa-home text-lg"></i>
            <span class="text-[10px]">é¦–é </span>
        </a>
        <a href="#" class="flex flex-col items-center gap-1 text-gray-400 w-1/5 hover:text-kd">
            <i class="fas fa-th-large text-lg"></i>
            <span class="text-[10px]">åˆ†é¡</span>
        </a>
        
        <!-- Center Action Button (Orders) -->
        <a href="#" class="flex flex-col items-center gap-1 text-gray-400 w-1/5 hover:text-kd relative">
            <div class="absolute -top-6 bg-kd w-12 h-12 rounded-full border-4 border-gray-100 flex items-center justify-center text-white shadow-lg">
                <i class="fas fa-clipboard-list text-xl"></i>
            </div>
            <span class="text-[10px] mt-7">æŸ¥è¨‚å–®</span>
        </a>

        <a href="#" class="flex flex-col items-center gap-1 text-gray-400 w-1/5 hover:text-kd" onclick="alert('é–‹å•Ÿæ¥­å‹™å°è©±è¦–çª—')">
            <i class="fas fa-comment-alt text-lg"></i>
            <span class="text-[10px]">è¯çµ¡æ¥­å‹™</span>
        </a>
        <a href="#" class="flex flex-col items-center gap-1 text-gray-400 w-1/5 hover:text-kd">
            <i class="fas fa-user text-lg"></i>
            <span class="text-[10px]">æœƒå“¡</span>
        </a>
    </nav>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg text-sm shadow-lg hidden z-50 flex items-center gap-2">
        <i class="fas fa-check-circle text-green-400"></i>
        <span>å·²åŠ å…¥è³¼ç‰©è»Š</span>
    </div>

    <!-- Share Dialog -->
    <div id="shareModal" class="share-overlay">
        <div class="share-dialog">
            <div class="share-header">
                åˆ†äº«çµ¦æ‚¨çš„å®¶äººæœ‹å‹ï¼
            </div>
            
            <div class="share-buttons">
                <div class="share-btn" onclick="shareToLine(event)">
                    <div class="share-btn-icon line-btn">ğŸ“±</div>
                    <div>Line</div>
                </div>
                
                <div class="share-btn" onclick="copyLink(event)">
                    <div class="share-btn-icon copy-btn">ğŸ”—</div>
                    <div>è¤‡è£½é€£çµ</div>
                </div>
            </div>
            
            <button class="close-btn" onclick="closeShareDialog(event)">å–æ¶ˆ</button>
        </div>
    </div>

    <!-- Share Toast -->
    <div id="shareToast" class="share-toast"></div>

    <!-- Javascript -->
    <script>
        // Mock Data: KD Tools & Materials
        const products = [
            // è§’ç·šæ¼†/è Ÿç­†é¡åˆ¥
            {
                id: 1,
                category: 'paint',
                name: 'ä¿®é‚Šç­†',
                price: 60,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/ä¿®é‚Šç­†.png',
                tag: 'ä¾¿æ”œ'
            },
            {
                id: 2,
                category: 'paint',
                name: 'ä¿®é‚Šè Ÿç­†',
                price: 85,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/ä¿®é‚Šè Ÿç­†.png',
                tag: 'ç†±éŠ·'
            },
            {
                id: 3,
                category: 'paint',
                name: 'è§’ç·šæ¼†(å«ä¿®é‚Šç­†)',
                price: 170,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/è§’ç·šæ¼†(å«ä¿®é‚Šç­†).png',
                tag: 'å¥—çµ„'
            },
            {
                id: 4,
                category: 'paint',
                name: 'è§’ç·šæ¼†çµ„(å«ä¿®é‚Šç­†ç ‚ç´™)',
                price: 240,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/è§’ç·šæ¼†çµ„(å«ä¿®é‚Šç­†ç ‚ç´™).png',
                tag: 'å®Œæ•´å¥—çµ„'
            },
            // å¼·åŠ›è† é¡åˆ¥
            {
                id: 5,
                category: 'glue',
                name: 'å™´è† -ç§‘å®š300(14.2KG-10æ¡¶)',
                price: 16000,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/å™´è† -ç§‘å®š300(14.2KG-10æ¡¶).png',
                tag: 'æ‰¹é‡å„ªæƒ '
            },
            {
                id: 6,
                category: 'glue',
                name: 'å™´è† -ç§‘å®š300(14.2KG)',
                price: 1700,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/å™´è† -ç§‘å®š300(14.2KG).png',
                tag: 'å°ˆæ¥­ç”¨'
            },
            {
                id: 7,
                category: 'glue',
                name: 'å™´è† -ç§‘å®š300(3KG)',
                price: 400,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/å™´è† -ç§‘å®š300(3KG).png',
                tag: 'å°åŒ…è£'
            },
            {
                id: 8,
                category: 'glue',
                name: 'å¡—è† -ç§‘å®š305(14.2KG-10æ¡¶)',
                price: 16000,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/å¡—è† -ç§‘å®š305(14.2KG-10æ¡¶).png',
                tag: 'æ‰¹é‡å„ªæƒ '
            },
            {
                id: 9,
                category: 'glue',
                name: 'å¡—è† -ç§‘å®š305(14.2KG)',
                price: 1700,
                originalPrice: null,
                image: 'å•†å“åœ–ç‰‡/å¡—è† -ç§‘å®š305(14.2KG).png',
                tag: 'å°ˆæ¥­ç”¨'
            }
        ];

        const categories = [
            { id: 'all', name: 'å…¨éƒ¨å•†å“' },
            { id: 'glue', name: 'å¼·åŠ›è† ' },
            { id: 'paint', name: 'è§’ç·šæ¼†/è Ÿç­†' },
            { id: 'tools', name: 'å·¥å…·é…ä»¶' },
            { id: 'materials', name: 'è£ä¿®åº•æ' }
        ];

        let currentCategory = 'all';
        let cartCount = 0;

        // Render Functions
        function renderCategories() {
            const container = document.getElementById('category-container');
            container.innerHTML = categories.map(cat => `
                <button 
                    onclick="filterCategory('${cat.id}')"
                    class="whitespace-nowrap px-4 py-1.5 rounded-full text-sm font-medium transition-colors duration-200 ${
                        currentCategory === cat.id 
                        ? 'bg-kd text-white shadow-md' 
                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                    }">
                    ${cat.name}
                </button>
            `).join('');
        }

        function renderProducts() {
            const grid = document.getElementById('product-grid');
            const countLabel = document.getElementById('product-count');
            
            const filtered = currentCategory === 'all' 
                ? products 
                : products.filter(p => p.category === currentCategory);
            
            countLabel.innerText = filtered.length;

            grid.innerHTML = filtered.map(product => `
                <div onclick="openProductDetail(${product.id})" class="bg-white rounded-lg card-shadow overflow-hidden flex flex-col h-full active:scale-[0.98] transition-transform duration-100 cursor-pointer">
                    <div class="relative w-full h-40 bg-gray-200 flex items-center justify-center overflow-hidden">
                        <!-- Real Product Image -->
                        <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover">
                        ${product.tag ? `<span class="absolute top-2 left-2 bg-red-500 text-white text-[10px] px-2 py-0.5 rounded shadow">${product.tag}</span>` : ''}
                    </div>
                    
                    <div class="p-3 flex flex-col flex-grow">
                        <h4 class="text-sm font-bold text-gray-800 line-clamp-2 leading-relaxed h-10 mb-1">${product.name}</h4>
                        
                        <div class="mt-auto">
                            <div class="flex items-baseline gap-2">
                                <span class="text-red-600 font-bold text-lg">NT$${product.price}</span>
                                ${product.originalPrice ? `<span class="text-xs text-gray-400 line-through">NT$${product.originalPrice}</span>` : ''}
                            </div>
                            
                            <button 
                                onclick="addToCart(this)"
                                class="w-full mt-3 bg-white border border-kd text-kd hover:bg-kd hover:text-white py-2 rounded font-medium text-sm transition-colors duration-200 flex items-center justify-center gap-1">
                                <i class="fas fa-cart-plus"></i>
                                åŠ å…¥è³¼ç‰©è»Š
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Logic Functions
        function filterCategory(catId) {
            currentCategory = catId;
            renderCategories();
            renderProducts();
        }

        function addToCart(btn) {
            // UI Feedback
            cartCount++;
            const badge = document.getElementById('cart-badge');
            badge.innerText = cartCount;
            badge.classList.remove('scale-0');
            
            // Button Animation
            const originalText = btn.innerHTML;
            btn.classList.add('bg-kd', 'text-white');
            btn.classList.remove('bg-white', 'text-kd');
            btn.innerHTML = '<i class="fas fa-check"></i> å·²åŠ å…¥';
            
            setTimeout(() => {
                btn.classList.remove('bg-kd', 'text-white');
                btn.classList.add('bg-white', 'text-kd');
                btn.innerHTML = originalText;
            }, 1000);

            // Toast Notification
            showToast();
        }

        function showToast() {
            const toast = document.getElementById('toast');
            toast.classList.remove('hidden');
            toast.classList.add('toast-enter');
            
            // Reset after 2 seconds
            setTimeout(() => {
                toast.classList.remove('toast-enter');
                toast.classList.add('hidden');
            }, 2000);
        }

        // Open product detail page
        function openProductDetail(productId) {
            window.location.href = `product-detail.html?id=${productId}`;
        }

        // Share functions - Fixed version
        function openShareDialog(event) {
            console.log('ğŸš€ é–‹å§‹åŸ·è¡Œ openShareDialog()');
            
            // é˜»æ­¢äº‹ä»¶å†’æ³¡
            if (event) {
                event.preventDefault();
                event.stopPropagation();
                console.log('ğŸ›‘ äº‹ä»¶å†’æ³¡å·²é˜»æ­¢');
            }
            
            try {
                const modal = document.getElementById('shareModal');
                console.log('ğŸ” æ‰¾åˆ°çš„ modal å…ƒç´ :', modal);
                
                if (modal) {
                    console.log('ğŸ¯ æº–å‚™æ·»åŠ  show class');
                    modal.classList.add('show');
                    console.log('âœ… show class å·²æ·»åŠ ');
                    console.log('ğŸ“ ç›®å‰çš„ classList:', modal.classList.toString());
                    
                    // ç­‰ä¸€ä¸‹å†æª¢æŸ¥æ˜¯å¦çœŸçš„é¡¯ç¤º
                    setTimeout(() => {
                        const computedStyle = window.getComputedStyle(modal);
                        console.log('ğŸ” æª¢æŸ¥é¡¯ç¤ºç‹€æ…‹ - display:', computedStyle.display);
                        console.log('ğŸ” æª¢æŸ¥é¡¯ç¤ºç‹€æ…‹ - visibility:', computedStyle.visibility);
                    }, 100);
                } else {
                    console.error('âŒ æ‰¾ä¸åˆ° shareModal å…ƒç´ ï¼');
                }
            } catch (error) {
                console.error('ğŸ’¥ openShareDialog() ç™¼ç”ŸéŒ¯èª¤:', error);
            }
        }

        function closeShareDialog(event) {
            console.log('ğŸ”’ åŸ·è¡Œ closeShareDialog()');
            
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const modal = document.getElementById('shareModal');
            if (modal) {
                modal.classList.remove('show');
                console.log('âœ… å°è©±æ¡†å·²é—œé–‰');
            }
        }

        function shareToLine(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const url = window.location.href;
            const text = 'ç§‘å®šä¼æ¥­è¡Œå‹•ä¸‹å–®å¹³å°\nå°ˆæ¥­è£ä¿®ææ–™ï¼Œå“è³ªä¿è­‰';
            const lineUrl = `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`;
            
            console.log('ğŸ“¤ åˆ†äº«åˆ° LINE...');
            window.open(lineUrl, '_blank');
            closeShareDialog();
            showShareToast('å·²åˆ†äº«åˆ° LINE');
        }

        function copyLink(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const url = window.location.href;
            console.log('ğŸ“‹ è¤‡è£½é€£çµ:', url);
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    closeShareDialog();
                    showShareToast('é€£çµå·²è¤‡è£½åˆ°å‰ªè²¼æ¿');
                }).catch(() => {
                    fallbackCopyText(url);
                });
            } else {
                fallbackCopyText(url);
            }
        }

        function fallbackCopyText(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                closeShareDialog();
                showShareToast('é€£çµå·²è¤‡è£½åˆ°å‰ªè²¼æ¿');
            } catch (error) {
                closeShareDialog();
                showShareToast('ç„¡æ³•è¤‡è£½é€£çµ');
            }
            
            document.body.removeChild(textArea);
        }

        function showShareToast(message) {
            const toast = document.getElementById('shareToast');
            toast.textContent = message;
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 2000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderCategories();
            renderProducts();
            console.log('ğŸš€ é¦–é è¼‰å…¥å®Œæˆ');
            console.log('ğŸ” shareModal å…ƒç´ :', document.getElementById('shareModal'));
        });

    </script>
</body>
</html>